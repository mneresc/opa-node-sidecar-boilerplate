<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="958px" preserveAspectRatio="none" style="width:1169px;height:958px;background:#FFFFFF;" version="1.1" viewBox="0 0 1169 958" width="1169px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="397" x="382.25" y="29.5332">OPA Sidecar + Node &#8212; Fluxo de decis&#227;o (PEP / PDP / PIP)</text><rect fill="#FFFFFF" height="450.9766" style="stroke:#181818;stroke-width:1.0;" width="10" x="410" y="292.5859"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="645" y="391.9922"/><rect fill="#FFFFFF" height="184.4609" style="stroke:#181818;stroke-width:1.0;" width="10" x="844" y="469.0469"/><rect fill="none" height="231.6484" style="stroke:#000000;stroke-width:1.5;" width="875" x="10" y="612.8047"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="45" x2="45" y1="124.8281" y2="861.4531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="415" x2="415" y1="124.8281" y2="861.4531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="649.5" x2="649.5" y1="124.8281" y2="861.4531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="849" x2="849" y1="124.8281" y2="861.4531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1089.5" x2="1089.5" y1="124.8281" y2="861.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="20" y="121.752">Cliente</text><ellipse cx="45" cy="55.7188" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M45,63.7188 L45,90.7188 M32,71.7188 L58,71.7188 M45,90.7188 L32,105.7188 M45,90.7188 L58,105.7188 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="20" y="874.9863">Cliente</text><ellipse cx="45" cy="886.5625" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M45,894.5625 L45,921.5625 M32,902.5625 L58,902.5625 M45,921.5625 L32,936.5625 M45,921.5625 L58,936.5625 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="72" x="379" y="74.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="386" y="96.1426">Node API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="396.5" y="113.752">(PEP)</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="72" x="379" y="860.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="386" y="881.9863">Node API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="396.5" y="899.5957">(PEP)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="608.5" y="104.1426">PostgreSQL</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="631.5" y="121.752">(PIP)</text><path d="M632,53.6094 C632,43.6094 650,43.6094 650,43.6094 C650,43.6094 668,43.6094 668,53.6094 L668,79.6094 C668,89.6094 650,89.6094 650,89.6094 C650,89.6094 632,89.6094 632,79.6094 L632,53.6094 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M632,53.6094 C632,63.6094 650,63.6094 650,63.6094 C650,63.6094 668,63.6094 668,53.6094 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="608.5" y="874.9863">PostgreSQL</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="631.5" y="892.5957">(PIP)</text><path d="M632,905.6719 C632,895.6719 650,895.6719 650,895.6719 C650,895.6719 668,895.6719 668,905.6719 L668,931.6719 C668,941.6719 650,941.6719 650,941.6719 C650,941.6719 632,941.6719 632,931.6719 L632,905.6719 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M632,905.6719 C632,915.6719 650,915.6719 650,915.6719 C650,915.6719 668,915.6719 668,905.6719 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="52" x="823" y="74.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="834.5" y="96.1426">OPA</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="830" y="113.752">(PDP)</text><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="52" x="823" y="860.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="834.5" y="881.9863">OPA</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="830" y="899.5957">(PDP)</text><rect fill="#E2E2F0" height="49.2188" style="stroke:#181818;stroke-width:0.5;" width="131" x="1026.5" y="70.6094"/><rect fill="#E2E2F0" height="49.2188" style="stroke:#181818;stroke-width:0.5;" width="131" x="1022.5" y="74.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="1054.5" y="96.1426">data/*.json</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="1029.5" y="113.752">(config por tenant)</text><rect fill="#E2E2F0" height="49.2188" style="stroke:#181818;stroke-width:0.5;" width="131" x="1026.5" y="860.4531"/><rect fill="#E2E2F0" height="49.2188" style="stroke:#181818;stroke-width:0.5;" width="131" x="1022.5" y="864.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="1054.5" y="885.9863">data/*.json</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="1029.5" y="903.5957">(config por tenant)</text><rect fill="#FFFFFF" height="450.9766" style="stroke:#181818;stroke-width:1.0;" width="10" x="410" y="292.5859"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="645" y="391.9922"/><rect fill="#FFFFFF" height="184.4609" style="stroke:#181818;stroke-width:1.0;" width="10" x="844" y="469.0469"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1162.5" x="0" y="156.0039"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1162.5" y1="156.0039" y2="156.0039"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1162.5" y1="159.0039" y2="159.0039"/><rect fill="#EEEEEE" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="108" x="527.25" y="144.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="90" x="533.25" y="162.3232">Boot / preload</text><polygon fill="#181818" points="860,213.8828,850,217.8828,860,221.8828,856,217.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="854" x2="1089" y1="217.8828" y2="217.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="866" y="204.8506">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="877" y="196.6748">Carrega/atualiza dados version&#225;veis</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="877" y="213.0264">(limites, canais, etc.)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1162.5" x="0" y="247.0586"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1162.5" y1="247.0586" y2="247.0586"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1162.5" y1="250.0586" y2="250.0586"/><rect fill="#EEEEEE" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="88" x="537.25" y="235.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="70" x="543.25" y="253.3779">Requisi&#231;&#227;o</text><polygon fill="#181818" points="398,288.5859,408,292.5859,398,296.5859,402,292.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="45" x2="404" y1="292.5859" y2="292.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="52" y="287.7295">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335" x="63" y="287.7295">HTTP request (headers: X-Tenant-Id, X-User-Id, X-Channel)</text><path d="M425,305.5859 L425,347.5859 L685,347.5859 L685,315.5859 L675,305.5859 L425,305.5859 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M675,305.5859 L675,315.5859 L685,315.5859 L675,305.5859 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239" x="431" y="324.0811">Coleta contexto (usu&#225;rio, canal, recurso),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="431" y="340.4326">gera requestId e prepara input-base</text><polygon fill="#181818" points="633,387.9922,643,391.9922,633,395.9922,637,391.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="420" x2="639" y1="391.9922" y2="391.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="427" y="378.96">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="438" y="370.7842">Consultar dados do dom&#237;nio</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="438" y="387.1357">(ex.: saque, pap&#233;is/roles, valores)</text><polygon fill="#181818" points="431,418.3438,421,422.3438,431,426.3438,427,422.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="425" x2="649" y1="422.3438" y2="422.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="437" y="417.4873">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="448" y="417.4873">Retorna dados (valor, roles, etc.)</text><polygon fill="#181818" points="832,465.0469,842,469.0469,832,473.0469,836,469.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="420" x2="838" y1="469.0469" y2="469.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="427" y="456.0146">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="250" x="438" y="447.8389">POST http://opa:8181/v1/data/saques/allow</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="394" x="438" y="464.1904">body: input JSON (tenant, action, subject, resource, context, config)</text><path d="M725,482.0469 L725,557.0469 L973,557.0469 L973,492.0469 L963,482.0469 L725,482.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M963,482.0469 L963,492.0469 L973,492.0469 L963,482.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="731" y="500.542">Avalia&#231;&#227;o Rego (PDP)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="731" y="516.8936">- pol&#237;ticas *.rego</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227" x="731" y="533.2451">- entrypoint: allow / reason / obligations</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="731" y="549.5967">- usa input + DATA</text><line style="stroke:#181818;stroke-width:1.0;" x1="854" x2="896" y1="584.8047" y2="584.8047"/><line style="stroke:#181818;stroke-width:1.0;" x1="896" x2="896" y1="584.8047" y2="597.8047"/><line style="stroke:#181818;stroke-width:1.0;" x1="855" x2="896" y1="597.8047" y2="597.8047"/><polygon fill="#181818" points="865,593.8047,855,597.8047,865,601.8047,861,597.8047" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="861" y="579.9482">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="872" y="579.9482">Avaliar pol&#237;tica (Rego)</text><path d="M10,612.8047 L71,612.8047 L71,621.1563 L61,631.1563 L10,631.1563 L10,612.8047 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="231.6484" style="stroke:#000000;stroke-width:1.5;" width="875" x="10" y="612.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="627.2998">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="78" x="86" y="626.2236">[allow == true]</text><polygon fill="#181818" points="431,649.5078,421,653.5078,431,657.5078,427,653.5078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="425" x2="848" y1="653.5078" y2="653.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="437" y="648.6514">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236" x="448" y="648.6514">decision {allow: true, reason, obligations}</text><line style="stroke:#181818;stroke-width:1.0;" x1="420" x2="462" y1="700.2109" y2="700.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="462" x2="462" y1="700.2109" y2="713.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="421" x2="462" y1="713.2109" y2="713.2109"/><polygon fill="#181818" points="431,709.2109,421,713.2109,431,717.2109,427,713.2109" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="427" y="687.1787">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="438" y="679.0029">Aplicar decis&#227;o (enforcement)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="438" y="695.3545">(efetivar a&#231;&#227;o, log/auditoria)</text><polygon fill="#181818" points="56,739.5625,46,743.5625,56,747.5625,52,743.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="50" x2="414" y1="743.5625" y2="743.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="62" y="738.7061">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="73" y="738.7061">200 OK (a&#231;&#227;o permitida)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="885" y1="752.5625" y2="752.5625"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="82" x="15" y="763.9814">[allow == false]</text><polygon fill="#181818" points="426,785.75,416,789.75,426,793.75,422,789.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="420" x2="848" y1="789.75" y2="789.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="432" y="784.8936">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="450" y="784.8936">decision {allow: false, reason}</text><polygon fill="#181818" points="56,832.4531,46,836.4531,56,840.4531,52,836.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="50" x2="414" y1="836.4531" y2="836.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="62" y="823.4209">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="80" y="815.2451">403 Forbidden (a&#231;&#227;o negada)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="80" y="831.5967">body: reason</text><!--SRC=[XLJ1RXCn4BtlLunwIc3JRO43Mgb8eG4HG7HfWyIXbybwaXgvdiNsXXQ4n4Vm0uW3ui1Nv4_u4iRUR9fA82w9lPvvy-RDiuCEXk2a6iEPLbIZWxlmYXN1xozVuQbfhnXa8oVQhxyp3Aed5HHGJTBlj1fcs0QsxUMSN9PX7TZ1iT5a0sKDkg1htQ0Di9SmnzNqt4Q8uHwW1rba2WFEqHFiLUp3qj7PwvSnPjh7JAlRG48rda_wyqcLrMmCrK6pzR0N0Oix- -yyMuchsIxq4XgX5SWAG9Sr6S_6MNPq18-PWtJIE3AC2ewEidW4ez6Zr6C9n-WSBR70qABH7n4KAlQm8kUbtlhRYhINEaPVwa0-XnejQlcdKEyFKubJUjzghzS_edvIO2CFn19FOebdira5JgB81nXS42e1B-7jQ9OOZwOgbyqRJswpFBv0QyaCezvwXO8LbRGi2wUN5m5uaRu07BEXW20g1BeAChxMj-jlJdD7rEHIjswTvs4kqKjos1EPAg0eYsYFe6tJXb4SKqPMGQoKPP5yx66QP1BjMnF4Ffq-Icp3b-jVLhEeGrVx9NWKu1mQRDO_jI-SK1ETLcZOaT_jHIOUGKTRWKv9R6LxwGSfHPXt09tGYcxbRycb6LOdPpEu2A4fYu8RB1yUFZmiLeT5iagYvGiqXZ-SspchwxBh5vwVdRo2GMUR730PB0VVpj-9sQ9odbjNIqiRUTD2tBRRosGp5nR3f1t0MFXhxEnmIijufyJCSZ0IcvhrBx6wEFJEljYEqrTnYxjkMDjGGg8fXdM4Od1PyDpe9IRlf-3MRyObzpYvV3kmgCLMaew4kwa8WyX578icRAg8TuDhIM1JwdOSwJ6GWl0fnPKfAjzGodSPVPRStSca_llH9AnnOtHyT6uU6B8B5bKlfUjXjCw2OhQ3Jh4S32yBR9KMIsWSzdW2sD-h4kuT7C392nXiH6x8oUNKAaNlqf4hGaQUdcsx2vJj__jDONt3_-xn5gS71_VXARkvLehibfgLfqLuzRxh4F_2qge_]--></g></svg>